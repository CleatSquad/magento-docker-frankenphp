---
name: PR Welcome Comment

on:
  pull_request:
    types: [opened]
    branches:
      - main

permissions:
  pull-requests: write

jobs:
  welcome:
    name: Welcome Comment
    runs-on: ubuntu-latest
    steps:
      - name: Post welcome comment
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          PR_NUMBER: ${{ github.event.pull_request.number }}
          PR_AUTHOR: ${{ github.event.pull_request.user.login }}
        run: |
          BODY="Hi @${PR_AUTHOR}! Thanks for your contribution!

          ## Available Bot Commands

          You can use the following commands in PR comments:

          | Command | Description |
          |---------|-------------|
          | \`@bot lint\` | Run ShellCheck + Hadolint + YAMLlint manually |
          | \`@bot build\` | Build and test Docker images (dev + prod) |
          | \`@bot security-scan\` | Scan Docker images for vulnerabilities (Trivy) |
          | \`@bot performance-test\` | Basic performance test (container startup times) |
          | \`@bot cleanup\` | Clean CI resources (images, volumes, networks) |
          | \`@bot smoke-test\` | Run Docker infrastructure smoke test |
          | \`@bot help\` | Show all available @bot commands |

          ## Before Merging

          - [ ] All CI checks pass
          - [ ] Documentation updated (if applicable)

          "

          gh api repos/${{ github.repository }}/issues/${PR_NUMBER}/comments \
            -X POST -f body="$BODY"
